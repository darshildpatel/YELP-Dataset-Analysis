{"paragraphs":[{"text":"%pig\nREGISTER 'hdfs://dumbo/user/ddp337/elephant-bird-core-4.15.jar'\nREGISTER 'hdfs://dumbo/user/ddp337/elephant-bird-hadoop-compat-4.15.jar'\nREGISTER 'hdfs://dumbo/user/ddp337/elephant-bird-pig-4.15.jar'\nREGISTER 'hdfs://dumbo/user/ddp337/json-simple-1.1.1.jar'","user":"anonymous","dateUpdated":"2018-03-24T20:04:28-0400","config":{"colWidth":12,"editorMode":"ace/mode/pig","results":{},"enabled":true,"editorSetting":{"language":"pig","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1521926780731_-2112996820","id":"20180303-190846_1795574035","dateCreated":"2018-03-24T17:26:20-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:349","dateFinished":"2018-03-24T20:04:29-0400","dateStarted":"2018-03-24T20:04:29-0400"},{"text":"%pig\nbusiness = LOAD 'hdfs://dumbo/user/ddp337/business.json' USING com.twitter.elephantbird.pig.load.JsonLoader('-nestedLoad') as (row:map[]);\nbusiness = FOREACH business GENERATE FLATTEN(row#'categories') AS categories,row#'business_id' AS business_id ,LOWER(row#'city') AS city;\n\nuscities = LOAD 'hdfs://dumbo/user/ddp337/uscitiesv1.3.csv' USING PigStorage(',');\nuscities = DISTINCT(FOREACH uscities GENERATE LOWER($0) AS city);\nuscities = FILTER uscities BY city != 'city';\n\nreview = LOAD 'hdfs://dumbo/user/ddp337/review.json' USING com.twitter.elephantbird.pig.load.JsonLoader('-nestedLoad') as (row:map[]);","dateUpdated":"2018-03-24T20:04:35-0400","config":{"tableHide":false,"editorSetting":{"language":"pig","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/pig","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1521926780732_-2114920564","id":"20180303-192316_797923348","dateCreated":"2018-03-24T17:26:20-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:350","user":"anonymous","dateFinished":"2018-03-24T20:04:36-0400","dateStarted":"2018-03-24T20:04:35-0400"},{"text":"%pig\nbusiness_us = JOIN business BY city,uscities BY city;\n\nreview = FOREACH review GENERATE row#'business_id' AS business_id,row#'user_id' AS user_id;","dateUpdated":"2018-03-24T20:04:38-0400","config":{"tableHide":false,"editorSetting":{"language":"pig","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/pig","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1521926780732_-2114920564","id":"20180308-210100_1774614158","dateCreated":"2018-03-24T17:26:20-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:351","user":"anonymous","dateFinished":"2018-03-24T20:04:39-0400","dateStarted":"2018-03-24T20:04:38-0400"},{"text":"%pig\nbusiness_us_review = JOIN business_us BY business_id, review BY business_id;\nbusiness_us_review = FOREACH business_us_review GENERATE $0 as categories,$1 as business_id,$2 as city,$5 as user_id;\nbusiness_us_review_group = GROUP business_us_review BY (categories,city,user_id);\nbusiness_us_review_group1 = FOREACH business_us_review_group GENERATE FLATTEN(group) as (categories,city,user_id), COUNT(business_us_review);\nunique_review = GROUP business_us_review_group1 by (categories,city);\nunique_reviewed = FOREACH unique_review GENERATE FLATTEN(group) as (categories, city), COUNT(business_us_review_group1);\nDUMP unique_reviewed;\n--STORE unique_reviewed INTO 'hdfs://dumbo/user/ddp337/test/' using PigStorage(',');\n--STORE business_us_review_group1 INTO 'hdfs://dumbo/user/ddp337/test1/' using PigStorage(',');\n","dateUpdated":"2018-03-24T20:04:42-0400","config":{"tableHide":false,"editorSetting":{"language":"pig","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/pig","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521926780732_-2114920564","id":"20180321-030337_1966785837","dateCreated":"2018-03-24T17:26:20-0400","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:352","user":"anonymous","dateFinished":"2018-03-24T20:08:19-0400","dateStarted":"2018-03-24T20:04:42-0400"},{"text":"%pig\nSTORE unique_reviewed INTO 'hdfs://dumbo/user/ddp337/Output1/' using PigStorage(',');","dateUpdated":"2018-03-24T20:09:19-0400","config":{"tableHide":true,"editorSetting":{"language":"pig","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/pig","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1521926780733_-2115305313","id":"20180322-011529_1764089183","dateCreated":"2018-03-24T17:26:20-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:353","user":"anonymous","dateFinished":"2018-03-24T20:12:38-0400","dateStarted":"2018-03-24T20:09:19-0400"},{"text":"%pig\n","dateUpdated":"2018-03-24T17:26:20-0400","config":{"colWidth":12,"editorMode":"ace/mode/pig","results":{},"enabled":true,"editorSetting":{"language":"pig","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521926780733_-2115305313","id":"20180322-012518_313931813","dateCreated":"2018-03-24T17:26:20-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:354"}],"name":"Question 1","id":"2D9MRJFMX","angularObjects":{"2CFXK5J4Y:shared_process":[],"2CF295UYG:shared_process":[],"2CD6ZRPDJ:shared_process":[],"2CFG6Y8G3:shared_process":[],"2CFJKQVBN:shared_process":[],"2CGYXR37V:shared_process":[],"2CDY97F39:shared_process":[],"2CEC5KMFB:shared_process":[],"2CFFWS5P3:shared_process":[],"2CDM4T1EH:shared_process":[],"2CG949ZHZ:shared_process":[],"2CEJ86HV3:shared_process":[],"2CFGNABPQ:shared_process":[],"2CEZV3CHG:shared_process":[],"2CDUTWP3P:shared_process":[],"2CFXDXWCE:shared_process":[],"2CEZMWG72:shared_process":[],"2CFWFHNZR:shared_process":[],"2CG23YGEZ:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}