{"paragraphs":[{"text":"%pig\nREGISTER 'hdfs://dumbo/user/ddp337/elephant-bird-core-4.15.jar'\nREGISTER 'hdfs://dumbo/user/ddp337/elephant-bird-hadoop-compat-4.15.jar'\nREGISTER 'hdfs://dumbo/user/ddp337/elephant-bird-pig-4.15.jar'\nREGISTER 'hdfs://dumbo/user/ddp337/json-simple-1.1.1.jar'","user":"anonymous","dateUpdated":"2018-03-24T07:11:29-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"pig","editOnDblClick":false},"editorMode":"ace/mode/pig"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1521879412765_1667527178","id":"20180324-041652_671107063","dateCreated":"2018-03-24T04:16:52-0400","dateStarted":"2018-03-24T07:11:29-0400","dateFinished":"2018-03-24T07:11:29-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:352"},{"text":"%pig\nbusiness = LOAD 'hdfs://dumbo/user/ddp337/business.json' USING com.twitter.elephantbird.pig.load.JsonLoader('-nestedLoad') as (row:map[]);\nreview = LOAD 'hdfs://dumbo/user/ddp337/review.json' USING com.twitter.elephantbird.pig.load.JsonLoader('-nestedLoad') as (row:map[]);","user":"anonymous","dateUpdated":"2018-03-24T07:11:32-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"pig","editOnDblClick":false},"editorMode":"ace/mode/pig"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1521879437077_-1585293266","id":"20180324-041717_555531526","dateCreated":"2018-03-24T04:17:17-0400","dateStarted":"2018-03-24T07:11:32-0400","dateFinished":"2018-03-24T07:11:32-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:353"},{"text":"%pig\nbusiness_required = FOREACH business generate FLATTEN(row#'categories') as categories,row#'name' AS name,row#'business_id' AS business_id ,row#'city' AS city, row#'latitude' AS latitude, row#'longitude' AS longitude,ACOS(SIN(55.9469753*3.14159/180)*SIN((row#'latitude')*3.14159/180)+COS(55.9469753*3.14159/180)*COS((row#'latitude')*3.14159/180)*COS(-3.2096308*3.14159/180 - (row#'longitude')*3.14159/180))*6371 as distance;\nbusiness_required = FILTER business_required BY distance <=15 AND categories == 'Food';\nbusiness_required = FOREACH business_required GENERATE $0..$2;\n\nreview_required = FOREACH review GENERATE row#'business_id' AS business_id, (float)row#'stars' AS stars,row#'user_id' AS user_id,GetMonth(row#'date');","user":"anonymous","dateUpdated":"2018-03-24T07:11:34-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"pig","editOnDblClick":false},"editorMode":"ace/mode/pig"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521879451997_1264187737","id":"20180324-041731_231512298","dateCreated":"2018-03-24T04:17:31-0400","dateStarted":"2018-03-24T07:11:34-0400","dateFinished":"2018-03-24T07:11:34-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:355","results":{"code":"SUCCESS","msg":[]}},{"text":"%pig\nbusiness_plus_review = JOIN business_required BY business_id, review_required BY business_id;\nbusiness_plus_review = FOREACH business_plus_review GENERATE $0, $1, $2,$4;\nbusiness_plus_review_group = GROUP business_plus_review BY business_id;\nbusiness_plus_review_group = FOREACH business_plus_review_group GENERATE FLATTEN(group) AS business_id,AVG(business_plus_review.stars) AS avg_reviews;","user":"anonymous","dateUpdated":"2018-03-24T07:11:36-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"pig","editOnDblClick":false},"editorMode":"ace/mode/pig","tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521879574299_1954243374","id":"20180324-041934_2086085842","dateCreated":"2018-03-24T04:19:34-0400","dateStarted":"2018-03-24T07:11:36-0400","dateFinished":"2018-03-24T07:11:36-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:356","results":{"code":"SUCCESS","msg":[]}},{"text":"%pig\nsorted_reviewers = ORDER business_plus_review_group BY avg_reviews DESC;\ntop_10_reviewers = LIMIT sorted_reviewers 10;\nsorted_reviewers = ORDER business_plus_review_group BY avg_reviews ASC;\nbottom_10_reviewers = LIMIT sorted_reviewers 10;\ntop_bottom = UNION top_10_reviewers, bottom_10_reviewers;\ntop_bottom = ORDER top_bottom BY avg_reviews;","user":"anonymous","dateUpdated":"2018-03-24T07:11:39-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"pig","editOnDblClick":false},"editorMode":"ace/mode/pig"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521879873989_-1164532855","id":"20180324-042433_649857767","dateCreated":"2018-03-24T04:24:33-0400","dateStarted":"2018-03-24T07:11:39-0400","dateFinished":"2018-03-24T07:11:39-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:357","results":{"code":"SUCCESS","msg":[]}},{"text":"%pig\nsummary = JOIN top_bottom BY business_id, review_required by business_id;\nsummary = FOREACH summary GENERATE $0 as business_id,$3 as stars,$5 as month;\nsummary = FILTER summary BY month IN (1,2,3,4,5);\nsummarized = GROUP summary BY business_id;\nsummarized = FOREACH summarized GENERATE FLATTEN(group) as business_id, AVG(summary.stars);\nsummarized = JOIN summarized by business_id, business_required by business_id;\nsummarized = FOREACH summarized GENERATE $3, $1;\nDUMP summarized;","user":"anonymous","dateUpdated":"2018-03-24T07:11:43-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"pig","editOnDblClick":false},"editorMode":"ace/mode/pig"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521880641641_-1459544437","id":"20180324-043721_1557230532","dateCreated":"2018-03-24T04:37:21-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:358","dateFinished":"2018-03-24T07:17:31-0400","dateStarted":"2018-03-24T07:11:43-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(Ever So Sweet Cupcakes,5.0)\n(Margiotta,1.0)\n(Welch Fishmongers,5.0)\n(The Better Beverage Company,5.0)\n(The Broadsheet Bistro,2.5)\n(Over Langshaw Farmhouse Ice Cream,5.0)\n(The Golden Bite Take Away,5.0)\n(Zucchero Cafe Bar,1.0)\n(Uncle T's,5.0)\n(Findlays Of Portobello,5.0)\n(Rosevear Tea,5.0)\n(Belly Buster,5.0)\n(Tesco Extra,2.0)\n(Thaisanuk Restaurant,1.5)\n(Fresh Choice,1.0)\n(The Cocktail Emporium,5.0)\n(Tesco Express,2.0)\n"}]}},{"text":"%pig\nSTORE summarized INTO 'hdfs://dumbo/user/ddp337/Output5/' using PigStorage(',');","user":"anonymous","dateUpdated":"2018-03-24T07:17:38-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"pig","editOnDblClick":false},"editorMode":"ace/mode/pig"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521886678960_-2002214483","id":"20180324-061758_986967667","dateCreated":"2018-03-24T06:17:58-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1956","dateFinished":"2018-03-24T07:22:56-0400","dateStarted":"2018-03-24T07:17:38-0400","results":{"code":"SUCCESS","msg":[]}},{"text":"%pig\n","user":"anonymous","dateUpdated":"2018-03-24T07:17:38-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"pig","editOnDblClick":false},"editorMode":"ace/mode/pig"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521890258116_-70476744","id":"20180324-071738_1169777628","dateCreated":"2018-03-24T07:17:38-0400","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2438"}],"name":"Question 5","id":"2DBHZ4NVZ","angularObjects":{"2CFXK5J4Y:shared_process":[],"2CF295UYG:shared_process":[],"2CD6ZRPDJ:shared_process":[],"2CFG6Y8G3:shared_process":[],"2CFJKQVBN:shared_process":[],"2CGYXR37V:shared_process":[],"2CDY97F39:shared_process":[],"2CEC5KMFB:shared_process":[],"2CFFWS5P3:shared_process":[],"2CDM4T1EH:shared_process":[],"2CG949ZHZ:shared_process":[],"2CEJ86HV3:shared_process":[],"2CFGNABPQ:shared_process":[],"2CEZV3CHG:shared_process":[],"2CDUTWP3P:shared_process":[],"2CFXDXWCE:shared_process":[],"2CEZMWG72:shared_process":[],"2CFWFHNZR:shared_process":[],"2CG23YGEZ:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}