{"paragraphs":[{"text":"%pig\nREGISTER 'hdfs://dumbo/user/ddp337/elephant-bird-core-4.15.jar'\nREGISTER 'hdfs://dumbo/user/ddp337/elephant-bird-hadoop-compat-4.15.jar'\nREGISTER 'hdfs://dumbo/user/ddp337/elephant-bird-pig-4.15.jar'\nREGISTER 'hdfs://dumbo/user/ddp337/json-simple-1.1.1.jar'","user":"anonymous","dateUpdated":"2018-03-24T20:15:56-0400","config":{"colWidth":12,"editorMode":"ace/mode/pig","results":{},"enabled":true,"editorSetting":{"language":"pig","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1521892452713_657994654","id":"20180322-040256_625740694","dateCreated":"2018-03-24T07:54:12-0400","dateStarted":"2018-03-24T20:15:56-0400","dateFinished":"2018-03-24T20:15:56-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3014"},{"text":"%pig\nbusiness = LOAD 'hdfs://dumbo/user/ddp337/business.json' USING com.twitter.elephantbird.pig.load.JsonLoader('-nestedLoad') as (row:map[]);\nreview = LOAD 'hdfs://dumbo/user/ddp337/review.json' USING com.twitter.elephantbird.pig.load.JsonLoader('-nestedLoad') as (row:map[]);","user":"anonymous","dateUpdated":"2018-03-24T20:16:05-0400","config":{"colWidth":12,"editorMode":"ace/mode/pig","results":{},"enabled":true,"editorSetting":{"language":"pig","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1521892452714_659148901","id":"20180322-040337_1934489804","dateCreated":"2018-03-24T07:54:12-0400","dateStarted":"2018-03-24T20:16:05-0400","dateFinished":"2018-03-24T20:16:05-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3015"},{"text":"%pig\nbusiness = FOREACH business generate FLATTEN(row#'categories') as categories,row#'business_id' AS business_id ,row#'city' AS city;\nreview = FOREACH review GENERATE row#'business_id' AS business_id, (float)row#'stars' AS stars,row#'user_id' AS user_id;","user":"anonymous","dateUpdated":"2018-03-24T20:16:26-0400","config":{"tableHide":false,"editorSetting":{"language":"pig","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/pig","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1521892452714_659148901","id":"20180322-040703_1888526554","dateCreated":"2018-03-24T07:54:12-0400","dateStarted":"2018-03-24T20:16:26-0400","dateFinished":"2018-03-24T20:19:19-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3016"},{"text":"%pig\nbusiness_plus_review = JOIN business BY business_id, review BY business_id;\nbusiness_plus_review_group = GROUP business_plus_review BY (categories,city);\nbusiness_plus_review_group = FOREACH business_plus_review_group GENERATE FLATTEN(group) as (categories,city),AVG(business_plus_review.stars) AS stars;\nrank = RANK business_plus_review_group BY categories, stars DESC DENSE;\nDUMP rank;","user":"anonymous","dateUpdated":"2018-03-24T20:16:21-0400","config":{"tableHide":false,"editorSetting":{"language":"pig","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/pig","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521892452714_659148901","id":"20180322-040833_782260066","dateCreated":"2018-03-24T07:54:12-0400","dateStarted":"2018-03-24T20:16:22-0400","dateFinished":"2018-03-24T20:19:18-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3017","errorMessage":""},{"text":"%pig\nSTORE rank INTO 'hdfs://dumbo/user/ddp337/Output2/' using PigStorage(',');","user":"anonymous","dateUpdated":"2018-03-24T20:19:58-0400","config":{"colWidth":12,"editorMode":"ace/mode/pig","results":{},"enabled":true,"editorSetting":{"language":"pig","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1521892452715_658764152","id":"20180322-044417_1404217030","dateCreated":"2018-03-24T07:54:12-0400","dateStarted":"2018-03-24T20:19:58-0400","dateFinished":"2018-03-24T20:22:48-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3018"},{"text":"%pig\n","user":"anonymous","dateUpdated":"2018-03-24T07:59:03-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"pig","editOnDblClick":false},"editorMode":"ace/mode/pig"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521892743414_-1136136560","id":"20180324-075903_1377814187","dateCreated":"2018-03-24T07:59:03-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3019"}],"name":"Question 2","id":"2DA21BDFR","angularObjects":{"2CFXK5J4Y:shared_process":[],"2CF295UYG:shared_process":[],"2CD6ZRPDJ:shared_process":[],"2CFG6Y8G3:shared_process":[],"2CFJKQVBN:shared_process":[],"2CGYXR37V:shared_process":[],"2CDY97F39:shared_process":[],"2CEC5KMFB:shared_process":[],"2CFFWS5P3:shared_process":[],"2CDM4T1EH:shared_process":[],"2CG949ZHZ:shared_process":[],"2CEJ86HV3:shared_process":[],"2CFGNABPQ:shared_process":[],"2CEZV3CHG:shared_process":[],"2CDUTWP3P:shared_process":[],"2CFXDXWCE:shared_process":[],"2CEZMWG72:shared_process":[],"2CFWFHNZR:shared_process":[],"2CG23YGEZ:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}