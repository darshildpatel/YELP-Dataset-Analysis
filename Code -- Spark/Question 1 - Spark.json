{"paragraphs":[{"text":"%pyspark\nfrom pyspark.sql import SQLContext\nsqlContext = SQLContext(sc)\n\nbusiness = sqlContext.read.json('hdfs://dumbo/user/ddp337/business.json')\nreview = sqlContext.read.json('hdfs://dumbo/user/ddp337/review.json')\nuscities = sc.textFile('hdfs://dumbo/user/ddp337/uscitiesv1.3.csv').map(lambda line: line.split(\",\"))\nuscities = uscities.toDF(['city','city_ascii','state_id','state_name','county_name','county_fips','zip','lat','lng','population','source','id'])\n","user":"anonymous","dateUpdated":"2018-03-24T23:13:59-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521947298663_-473720418","id":"20180324-230818_700530512","dateCreated":"2018-03-24T23:08:18-0400","dateStarted":"2018-03-24T23:13:59-0400","dateFinished":"2018-03-24T23:13:59-0400","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:892"},{"text":"%pyspark\nbusiness_required=business.select(pyspark.sql.functions.explode(business.categories).alias('categories'),business.business_id,pyspark.sql.functions.upper(business.city).alias('city'))\nreview_required = review.select(review.user_id,review.business_id)\nuscities = uscities_raw.select(pyspark.sql.functions.upper(uscities_raw.city).alias('city'))\nuscities.registerTempTable('uscities')\nbusiness_required.registerTempTable('business_required')\nbusiness_required = sqlContext.sql('Select business_required.* FROM business_required JOIN uscities ON business_required.city = uscities.city')","user":"anonymous","dateUpdated":"2018-03-24T23:12:19-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521947371203_-1102861491","id":"20180324-230931_851962949","dateCreated":"2018-03-24T23:09:31-0400","dateStarted":"2018-03-24T23:12:19-0400","dateFinished":"2018-03-24T23:12:19-0400","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:893"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521947395837_1205109243","id":"20180324-230955_1332471817","dateCreated":"2018-03-24T23:09:55-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:894","text":"%pyspark\nbusiness_required.registerTempTable('business_required')\nreview_required.registerTempTable('review_required')\nbusiness_review = sqlContext.sql('Select business_required.*,review_required.user_id FROM business_required JOIN review_required ON business_required.business_id = review_required.business_id')\nbusiness_review.registerTempTable('business_review')\nfinal = sqlContext.sql('Select categories,city,COUNT(user_id) as unique_reviewers from business_review GROUP BY categories,city ORDER BY categories')\nfinal.write.mode('append').json(\"hdfs://dumbo/user/as11500/problem1_spark\")"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521947785556_40963052","id":"20180324-231625_2040106251","dateCreated":"2018-03-24T23:16:25-0400","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:970","text":"%pyspark\nfinal.show()"}],"name":"Question 1 - spark","id":"2D9P263GT","angularObjects":{"2CFXK5J4Y:shared_process":[],"2CF295UYG:shared_process":[],"2CD6ZRPDJ:shared_process":[],"2CFG6Y8G3:shared_process":[],"2CFJKQVBN:shared_process":[],"2CGYXR37V:shared_process":[],"2CDY97F39:shared_process":[],"2CEC5KMFB:shared_process":[],"2CFFWS5P3:shared_process":[],"2CDM4T1EH:shared_process":[],"2CG949ZHZ:shared_process":[],"2CEJ86HV3:shared_process":[],"2CFGNABPQ:shared_process":[],"2CEZV3CHG:shared_process":[],"2CDUTWP3P:shared_process":[],"2CFXDXWCE:shared_process":[],"2CEZMWG72:shared_process":[],"2CFWFHNZR:shared_process":[],"2CG23YGEZ:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}