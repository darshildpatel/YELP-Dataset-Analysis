{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521947692991_319046206","id":"20180324-231452_1137823655","dateCreated":"2018-03-24T23:14:52-0400","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:436","text":"%pyspark\nfrom pyspark.sql import SQLContext\nsqlContext = SQLContext(sc)\n\nbusiness = sqlContext.read.json('hdfs://dumbo/user/ddp337/business.json')\nreview = sqlContext.read.json('hdfs://dumbo/user/ddp337/review.json')\nuscities = sc.textFile('hdfs://dumbo/user/ddp337/uscitiesv1.3.csv').map(lambda line: line.split(\",\"))\nuscities = uscities.toDF(['city','city_ascii','state_id','state_name','county_name','county_fips','zip','lat','lng','population','source','id'])","dateUpdated":"2018-03-24T23:15:09-0400","dateFinished":"2018-03-24T23:15:09-0400","dateStarted":"2018-03-24T23:15:09-0400","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"java.lang.OutOfMemoryError: unable to create new native thread\n\tat java.lang.Thread.start0(Native Method)\n\tat java.lang.Thread.start(Thread.java:717)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:173)\n\tat org.apache.zeppelin.scheduler.FIFOScheduler$1.run(FIFOScheduler.java:139)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\n"}]}},{"text":"%pyspark\nbusiness_cityRank=business.select(pyspark.sql.functions.explode(business.categories).alias('categories'),business.business_id,business.city,business.stars)\nbusiness_cityRank.registerTempTable('business_cityRank')\nfinal_ranking = sqlContext.sql('select categories,city,AVG(stars) as stars from business_cityRank group by city,categories order by categories ASC, stars DESC')\nfinal_ranking.show()","user":"anonymous","dateUpdated":"2018-03-24T23:15:09-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521947709564_-1593324393","id":"20180324-231509_1887311284","dateCreated":"2018-03-24T23:15:09-0400","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:503"},{"text":"%pyspark\nfinal_ranking.write.mode('append').json(\"hdfs://dumbo/user/ddp337/problem2_spark\")\nprint(final_ranking)","user":"anonymous","dateUpdated":"2018-03-24T23:17:02-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521947822622_-387585926","id":"20180324-231702_1472647579","dateCreated":"2018-03-24T23:17:02-0400","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:581"}],"name":"Question 2-Spark","id":"2DBUXU163","angularObjects":{"2CFXK5J4Y:shared_process":[],"2CF295UYG:shared_process":[],"2CD6ZRPDJ:shared_process":[],"2CFG6Y8G3:shared_process":[],"2CFJKQVBN:shared_process":[],"2CGYXR37V:shared_process":[],"2CDY97F39:shared_process":[],"2CEC5KMFB:shared_process":[],"2CFFWS5P3:shared_process":[],"2CDM4T1EH:shared_process":[],"2CG949ZHZ:shared_process":[],"2CEJ86HV3:shared_process":[],"2CFGNABPQ:shared_process":[],"2CEZV3CHG:shared_process":[],"2CDUTWP3P:shared_process":[],"2CFXDXWCE:shared_process":[],"2CEZMWG72:shared_process":[],"2CFWFHNZR:shared_process":[],"2CG23YGEZ:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}